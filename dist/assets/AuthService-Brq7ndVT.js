const s=e=>{const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=crypto.getRandomValues(new Uint8Array(e));return Array.from(t).map(r=>o[r%o.length]).join("")},i=async e=>{const t=new TextEncoder().encode(e),r=await window.crypto.subtle.digest("SHA-256",t);return d(r)},d=e=>btoa(String.fromCharCode(...new Uint8Array(e))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),a="a7bee7f7781348199877e340dae76515",c=`${window.location.origin}/redirect`,l="user-read-private user-read-email",p=()=>{const e=s(64);window.localStorage.setItem("code_verifier",e),i(e).then(o=>{const t=new URL("https://accounts.spotify.com/authorize"),r={response_type:"code",client_id:a,scope:l,code_challenge_method:"S256",code_challenge:o,redirect_uri:c};t.search=new URLSearchParams(r).toString(),window.location.href=t.toString()})},h=async e=>{const o=window.localStorage.getItem("code_verifier"),t={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({client_id:a,grant_type:"authorization_code",code:e,redirect_uri:c,code_verifier:o})},n=await(await fetch("https://accounts.spotify.com/api/token",t)).json();localStorage.setItem("access_token",n.access_token),localStorage.setItem("refresh_token",n.refresh_token),localStorage.setItem("expires_in",n.expires_in)};export{p as a,h as g};
